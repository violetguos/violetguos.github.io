<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.663a57cba90c1fd1f705.css" id="gatsby-global-css">@import url(https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&display=swap);@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-191cc9f50f3b76b9617cb383f19acb7d.woff2) format("woff2"),url(/static/montserrat-latin-100-370318464551d5f25b0f0a78f374faac.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-bdeaeb79db315697bd173a55b097dc18.woff2) format("woff2"),url(/static/montserrat-latin-100italic-ecf7d49386e8f265878e735db34a7c4b.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-85d5ef9db7f2dc6979172a4a3b2c57cb.woff2) format("woff2"),url(/static/montserrat-latin-200-1fc98e126a3d152549240e6244d7e669.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-49095760a498d024fe1a85a078850df9.woff2) format("woff2"),url(/static/montserrat-latin-200italic-fe46cf8b9462c820457d3bf537e4057f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-7c3daf12b706645b5d3710f863a4da04.woff2) format("woff2"),url(/static/montserrat-latin-300-8dc95fab9cf98d02ca8d76e97d3dff60.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-f20b178ca2024a5eac8e42e6649db86c.woff2) format("woff2"),url(/static/montserrat-latin-300italic-3fe16939288856e8e828fa2661bf2354.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-bc3aa95dca08f5fee5291e34959c27bc.woff2) format("woff2"),url(/static/montserrat-latin-400-8102c4838f9e3d08dad644290a9cb701.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-5cad650422a7184467af5a4d17b264c4.woff2) format("woff2"),url(/static/montserrat-latin-400italic-d191f22af3bb50902b99ac577f81a322.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-92d16e458625f4d2c8940f6bdca0ff09.woff2) format("woff2"),url(/static/montserrat-latin-500-8b763220218ffc11c57c84ddb80e7b26.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-47bfcca6b69d6a9acca7a8bff17193e2.woff2) format("woff2"),url(/static/montserrat-latin-500italic-72c01f753c3940c0b9cb6bf2389caddf.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-6fb1b5623e528e27c18658fecf5ee0ee.woff2) format("woff2"),url(/static/montserrat-latin-600-7c839d15a6f54e7025ba8c0c4b333e8f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-60789af1c9338ed1a9546722ec54b4f7.woff2) format("woff2"),url(/static/montserrat-latin-600italic-f3d4de8d0afb19e777c79032ce828e3d.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-39d93cf678c740f9f6b2b1cfde34bee3.woff2) format("woff2"),url(/static/montserrat-latin-700-80f10bd382f0df1cd650fec59f3c9394.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-ba136d97b14e82284dd595e257f11c47.woff2) format("woff2"),url(/static/montserrat-latin-700italic-8c98142b425630821139c24bd1698700.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-b7018be9ed6cd94da8b6675b3a468c3b.woff2) format("woff2"),url(/static/montserrat-latin-800-9a9befcf50d64f9d2d19d8b1d1984add.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-540ffdd223d1a9ad3d4e678e1a23372e.woff2) format("woff2"),url(/static/montserrat-latin-800italic-897086f99f4e1f45e6b1e9368527d0bc.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-58cd789700850375b834e8b6776002eb.woff2) format("woff2"),url(/static/montserrat-latin-900-26d42c9428780e545a540bbb50c84bce.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-451157bc8861fe54f523b3669a3def71.woff2) format("woff2"),url(/static/montserrat-latin-900italic-a8ec4957e1c24f5793305763ad9845b3.woff) format("woff")}@keyframes fadeInUp{0%{transform:translate3d(0,100px,0)}to{transform:translateZ(0);opacity:1}}@keyframes opacity{0%{opacity:0}to{opacity:1}}:root #dark{--main-color:#fff;--text-color:#e6e6e6;--text-offset-color:#dedede;--bg-color:#262b2d;--primary-color:#f99b74;--primary-offset-color:#e68157;--selection-color:#da7146;--selection-offset-color:#a94f2b;--border-color:#575b5d;--border-offset-color:#e0e0e0}:root,:root #dark{--secondary-color:#3692a2;--gray-color:#a2a2a2}:root{--main-color:#262b2d;--text-color:#405058;--text-offset-color:#90a2ab;--bg-color:#fff;--primary-color:#d46132;--primary-offset-color:#e68157;--selection-color:#ffe9df;--selection-offset-color:#ffd9c9;--border-color:#ebebeb;--border-offset-color:#e0e0e0}article,aside,details,figcaption,figure,footer,header,hgroup,nav,section,summary{display:block}audio,canvas,video{display:inline-block}audio:not([controls]){display:none;height:0}[hidden],template{display:none}html{background:#fff;color:#000;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%}button,html,input,select,textarea{font-family:sans-serif}body{margin:0}a{background:transparent}a:focus{outline:thin dotted}a:active,a:hover{outline:0}h1{font-size:2em;margin:.67em 0}h2{font-size:1.5em;margin:.83em 0}h3{font-size:1.17em;margin:1em 0}h4{font-size:1em;margin:1.33em 0}h5{font-size:.83em;margin:1.67em 0}h6{font-size:.75em;margin:2.33em 0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}mark{background:#ff0;color:#000}code,kbd,pre,samp{font-family:monospace,serif;font-size:1em}pre{white-space:pre;white-space:pre-wrap;word-wrap:break-word}q{quotes:"\201C" "\201D" "\2018" "\2019"}q:after,q:before{content:"";content:none}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:0}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0;white-space:normal}button,input,select,textarea{font-family:inherit;font-size:100%;margin:0;vertical-align:baseline}button,input{line-height:normal}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}textarea{overflow:auto;vertical-align:top}table{border-collapse:collapse;border-spacing:0}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}html{box-sizing:border-box;overflow-y:scroll;font-size:100%}@media only screen and (max-width:767px){html{font-size:90%}}body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:1rem;line-height:1.625;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body #dark,body #white{width:100%;min-height:100vh;max-height:100%;color:var(--text-color);background-color:var(--bg-color);padding:25px 0;border-top:2px solid var(--primary-color)}ol{padding:0;margin:0;list-style:none}button{background-color:transparent}button,div.gatsby-resp-iframe-wrapper iframe{border:0}*,:after,:before{box-sizing:inherit;letter-spacing:.3px;transition:.15s}::selection{background-color:var(--selection-color);color:var(--main-color)}body{overflow-x:hidden;transition:color .15s,background-color .15s}body .container{width:920px;min-width:920px;margin:0 auto}@media only screen and (max-width:992px)and (min-width:767px){body .container{width:95%;min-width:95%;margin:0 auto}}@media only screen and (max-width:767px){body .container{width:98%;min-width:98%;margin:0 auto}}body #index,body #page{display:flex;transition:.3s;flex-direction:column;width:100%;min-width:920px;margin:0 auto;gap:50px}@media only screen and (max-width:992px)and (min-width:767px){body #index,body #page{width:100%;min-width:100%}}@media only screen and (max-width:767px){body #index,body #page{min-width:100%;width:100%}}h1,h2,h3,h4,h5,h6{margin:0;line-height:1.4;font-family:Playfair Display,serif}h1,h2,h3{font-weight:500;text-rendering:optimizeLegibility}h1{font-size:1.9rem}h2{font-size:1.7rem}h3{font-size:1.4rem}p{margin:0}a{text-decoration:none;color:var(--main-color);transition:.1s}a:hover{cursor:pointer}a.active,a:hover{color:var(--primary-color);transition:.1s}a::selection{color:var(--secondary-color)}#dark a::selection{color:var(--bg-color)}.display-font{font-family:Playfair Display,serif}header#top{display:flex;justify-content:space-between;flex-wrap:wrap}@media only screen and (max-width:992px)and (min-width:767px){header#top{width:95%}}@media only screen and (max-width:767px){header#top{align-items:center;flex-direction:column;gap:30px;width:95%;margin:0 auto}}header#top h1 a{text-decoration:none;font-size:1.5rem;background-color:var(--selection-color);padding:4px 8px;border-radius:5px;font-weight:500}header#top h1 a:hover{border:0;color:initial;transform:rotate(0);color:var(--main-color);background-color:var(--selection-offset-color)}header#top nav{display:flex;align-items:center;gap:30px}header#top nav a{font-weight:500;font-size:1.1rem}header#top nav a.active,header#top nav a:hover{border:0}header#top nav a[disabled]{color:var(--gray-color);user-select:none;-moz-user-select:none;-khtml-user-select:none;-webkit-user-select:none;-o-user-select:none}header#top nav a[disabled]:hover{cursor:not-allowed}header#top nav button{padding:0;outline:none}section.welcome{width:90%;margin:0 auto;display:grid;grid-template-areas:"image title" "image description";grid-column-gap:30px;padding:80px 0 100px;align-items:center}@media only screen and (max-width:992px)and (min-width:767px){section.welcome{width:95%}}@media only screen and (max-width:767px){section.welcome{align-items:center;flex-direction:column;gap:30px;width:95%;margin:0 auto;grid-template-areas:"image" "title" "description"}}section.welcome div.bio-avatar{grid-area:image;border-radius:10px;max-width:175px;max-height:175px}section.welcome h2{grid-area:title;text-transform:uppercase;font-size:1.1rem;color:var(--main-color);align-self:flex-end;font-weight:600}section.welcome p{grid-area:description;align-self:flex-start;color:var(--text-color);font-size:1.4rem;padding-top:10px}section.welcome p a{color:var(--primary-color);font-weight:500}section.welcome p a:hover{border-color:var(--secondary-color)}section#page-content{font-size:1.3rem;line-height:1.75}@media only screen and (max-width:767px){section#page-content{width:95%;margin:0 auto}}section#page-content p,section#page-content p ~ p{margin-bottom:1.8rem}.category-filter{display:flex;align-items:center;padding-bottom:50px;margin:50px 0 30px;border-bottom:1px solid var(--border-color)}@media only screen and (max-width:767px){.category-filter{width:95%;margin:50px auto 30px}}.category-filter h4{color:var(--main-color);font-size:1.2em;font-weight:600;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji}@media only screen and (max-width:767px){.category-filter h4{font-size:1.1em}}.category-filter ul{padding:0;display:flex;gap:10px;margin:0 0 0 10px;flex-wrap:wrap}.category-filter ul li{cursor:pointer;margin:0;list-style:none;background-color:var(--border-color);border-radius:5px;font-size:1rem;padding:5px 10px;font-weight:600}.category-filter ul li.active{background-color:var(--primary-color);color:var(--bg-color)}@media only screen and (max-width:767px){.category-filter ul li{fint-size:.9rem;padding:3px 7px}}#not-found{margin:50px 0}#not-found h1{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-weight:600;font-size:1.7rem;padding-bottom:10px}section.all-post-list h3{margin-bottom:30px;font-size:1.6rem;font-weight:700;color:var(--main-color);text-transform:uppercase;display:flex;white-space:nowrap;align-items:center}section.all-post-list h3:before{width:5%;margin-right:30px}section.all-post-list h3:after,section.all-post-list h3:before{height:10px;border-radius:5px;background:var(--border-color);content:""}section.all-post-list h3:after{width:100%;margin-left:30px}section.all-post-list .index-blog li a:hover{color:var(--text-color)}section.all-post-list .index-blog li a:hover h2{color:var(--primary-color)}section.all-post-list .index-blog li~li{margin-top:15px}section.all-post-list .index-blog li a{padding:20px;display:block}section.all-post-list .index-blog li:hover{color:initial;background-color:var(--border-color);border-radius:5px}section.all-post-list .index-blog li header h2{font-size:1.7rem;font-weight:600;position:relative}section.all-post-list .index-blog li header h2 span{width:9px;height:9px;border-radius:50%;background-color:var(--primary-color);position:absolute;left:-14px;transform:scale(1);animation:pulse 2s infinite}section.all-post-list .index-blog li header .top-of-header{display:flex;align-items:center;padding:12px 0}section.all-post-list .index-blog li header .top-of-header small{font-size:1rem;color:var(--gray-color)}section.all-post-list .index-blog li header .top-of-header ul{padding-left:20px;list-style:none;display:flex;align-items:center}section.all-post-list .index-blog li header .top-of-header ul:before{width:4px;height:4px;border-radius:50%;content:"";background-color:var(--gray-color)}section.all-post-list .index-blog li header .top-of-header ul li{padding:0 0 0 10px;color:var(--gray-color);font-weight:600}section.all-post-list .index-blog li section p{color:var(--text-color);font-size:1.1rem}section.all-post-list .index-view-more{max-width:-moz-fit-content;max-width:fit-content;display:flex;justify-content:flex-start;font-weight:500;font-size:1.1rem;margin-top:30px;color:var(--primary-color);gap:5px;align-items:center;animation:shake 3s cubic-bezier(.1,.1,.1,.1) infinite both}@media only screen and (max-width:992px)and (min-width:767px){section.all-post-list .index-view-more{margin-left:20px}}@media only screen and (max-width:767px){section.all-post-list .index-view-more{margin-left:20px}}@keyframes shake{10%,90%{transform:translate3d(-1px,0,0)}20%,80%{transform:translate3d(1px,0,0)}30%,50%,70%{transform:translate3d(-2px,0,0)}40%,60%{transform:translate3d(2px,0,0)}}@keyframes pulse{0%{transform:scale(.95);box-shadow:0 0 0 0 var(--primary-offset-color)}70%{transform:scale(1);box-shadow:0 0 0 10px transparent}to{transform:scale(.95);box-shadow:0 0 0 0 transparent}}footer{margin:60px 0 10px;border-top:1px solid var(--border-color);padding-top:40px;flex-direction:column;align-items:center}footer,footer nav{display:flex}footer nav a{font-size:1.2rem;color:var(--text-color);display:flex;align-items:center;padding:0 20px}@media only screen and (max-width:992px)and (min-width:767px){footer nav a{font-size:1rem;padding:0 10px}}@media only screen and (max-width:767px){footer nav a{padding:0 10px;font-size:1rem}}footer nav a:before{content:"";width:5px;height:4px;border-radius:20px;background-color:var(--gray-color);position:relative;right:18.5px}@media only screen and (max-width:767px){footer nav a:before{right:8.5px}}footer nav a:first-child:before{background-color:transparent}footer .email{padding-top:30px}article.blog-post{margin:40px 0}article.blog-post header{display:flex;flex-direction:column}article.blog-post header .top-of-post-image{order:2}article.blog-post header .top-of-post-image h1{font-size:2rem;color:var(--main-color);font-weight:600}article.blog-post header .top-of-post-image .top-of-header{display:flex;align-items:center}article.blog-post header .top-of-post-image .top-of-header small{font-size:1rem;color:var(--gray-color)}article.blog-post header .top-of-post-image .top-of-header ul{padding-left:20px;list-style:none;display:flex;align-items:center}article.blog-post header .top-of-post-image .top-of-header ul:before{width:4px;height:4px;border-radius:50%;content:"";background-color:var(--gray-color)}article.blog-post header .top-of-post-image .top-of-header ul li{padding:0 0 0 10px;color:var(--gray-color);font-weight:600}article.blog-post header .post-cover{width:100%;margin:0 auto 20px 0;border-radius:5px;max-height:400px}@media only screen and (max-width:767px){article.blog-post header .post-cover{margin-bottom:0}}article.blog-post section{font-size:1.2rem;line-height:1.75}@media only screen and (max-width:767px){article.blog-post section{width:95%;margin:0 auto}}article.blog-post section ol{padding-left:20px;list-style:decimal}article.blog-post section hr{display:flex;border:0;margin:40px 0}article.blog-post section hr:after{content:"";margin:0 auto;border-radius:50%;width:50px;height:30px;background-image:radial-gradient(circle,var(--text-offset-color),var(--text-offset-color) 3px,transparent 4px,transparent);background-size:16px 25px}article.blog-post section p,article.blog-post section p ~ p{margin-bottom:1.8rem}article.blog-post section div.twitter-tweet{margin:20px auto!important}article.blog-post section span.gatsby-resp-image-wrapper{margin:20px 0;border-radius:5px}article.blog-post section img{display:block;margin:0 auto}@media only screen and (max-width:767px){article.blog-post section img{width:100%}}article.blog-post section a{color:var(--primary-color)}article.blog-post section table{margin-bottom:30px;width:100%;text-align:left;color:#3f3f3f;border-collapse:collapse;border:1px solid #e8e8e8}article.blog-post section table tr:nth-child(2n){background-color:#f7f7f7}article.blog-post section table td,article.blog-post section table th{padding:10px 15px}article.blog-post section table th{background-color:#f0f0f0;border:1px solid #dedede;border-bottom-color:#c9c9c9}article.blog-post section table td{border:1px solid #e8e8e8}article.blog-post section h1,article.blog-post section h2,article.blog-post section h3,article.blog-post section h4,article.blog-post section h5{margin:40px 0 20px!important;color:var(--main-color);line-height:1.5rem;display:flex;white-space:nowrap;align-items:center;width:100%}article.blog-post section h1:before,article.blog-post section h2:before,article.blog-post section h3:before,article.blog-post section h4:before,article.blog-post section h5:before{width:3%;height:5px;border-radius:5px;background:var(--border-color);content:"";margin-right:14px}article.blog-post section h1:after,article.blog-post section h2:after,article.blog-post section h3:after,article.blog-post section h4:after,article.blog-post section h5:after{width:100%;height:5px;border-radius:5px;background:var(--border-color);content:"";margin-left:14px}@media only screen and (max-width:767px){article.blog-post section h1,article.blog-post section h2,article.blog-post section h3,article.blog-post section h4,article.blog-post section h5{font-size:1.5rem;white-space:pre-wrap}}article.blog-post section h1{margin-bottom:40px!important}blockquote{background-color:var(--border-color);padding:15px 15px 15px 20px;margin:20px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;border-left:5px solid var(--gray-color)}blockquote br{content:"";margin:3em;display:block;font-size:24%}blockquote p{margin-bottom:0!important}blockquote code{background:var(--border-offset-color)!important;color:var(--bg-color)!important}pre{font-size:1.08rem}.bottom-article{display:flex;align-items:center;justify-content:space-between;margin:30px 0;padding:30px 0;border-bottom:1px solid var(--border-color)}@media only screen and (max-width:767px){.bottom-article{width:95%;margin:30px auto}}.bottom-article .share-post{display:flex;gap:15px;align-items:center}.bottom-article .share-post .copy-icon{fill:var(--main-color);align-self:flex-start}.bottom-article .share-post .copy-icon:hover{cursor:copy}.bottom-article .like-count button{color:var(--primary-color);display:flex;align-items:center;gap:9px;font-weight:600;font-size:1.2rem;outline:none}.bottom-article .like-count button svg{fill:var(--primary-color)}nav.blog-post-nav{display:flex;justify-content:space-between;flex-wrap:wrap;padding:0;margin:40px 0 10px;gap:20px}nav.blog-post-nav li{background:var(--border-color);border-radius:5px;list-style:none;padding:20px 0}nav.blog-post-nav li a{font-weight:600;font-size:1.05rem;font-family:Playfair Display,serif;padding:20px}#webmentions{width:980px;margin:0 auto}@media only screen and (max-width:767px){#webmentions{width:95%!important}}#webmentions h2{margin:40px 0 25px}#webmentions h2 span{text-transform:uppercase;font-weight:600;font-size:1.6rem;display:flex;color:var(--main-color);align-items:center}#webmentions h2 span:before{width:5%;margin-right:30px}#webmentions h2 span:after,#webmentions h2 span:before{height:6px;border-radius:5px;background:var(--border-color);content:""}#webmentions h2 span:after{width:100%;margin-left:30px}#webmentions h2 a{background:#3294da;color:#fff;max-width:-moz-fit-content;max-width:fit-content;padding:20px 30px;border-radius:5px;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-weight:600;align-items:center;display:flex}#webmentions h2 a b{font-size:17px;padding-left:10px}#webmentions h2 a:hover{color:#e6e6e6}#webmentions .mention-web{flex-direction:column;border-left:2px solid var(--border-color);padding:10px 0 10px 20px!important}#webmentions .mention-web small{color:var(--border-color);font-weight:300}#webmentions .mention-web a{font-size:15px;color:var(--text-color)}#webmentions .mention{display:flex;padding:15px 10px 12px;font-size:15px}#webmentions .mention-own{background:var(--border-color);margin:0 12px 20px 60px;padding:20px 20px 17px;border-radius:6px}#webmentions .mention~.mention{margin-top:15px}#webmentions .mention .profilePhotoHolder{width:40px;margin-right:20px;flex-shrink:0;margin-top:0}#webmentions .mention .profilePhotoHolder .profilePhoto{width:40px;height:40px;border-radius:100%}#webmentions .mention .content{margin-top:-5px}#webmentions .mention .content .author{color:var(--main-color)}#webmentions .mention .content .link{color:var(--text-color)}#webmentions .mention .content .link small{color:var(--text-color);font-weight:300}#webmentions .mention .content .link:hover{text-decoration:underline}#webmentions .mention .content .mentionText{font-size:15px;line-height:20px;color:var(--text-color);margin-bottom:0}#webmentions .mention .content .url{width:350px;max-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:#00f;display:inline-block}@media only screen and (max-width:767px){#webmentions .mention .content .url{width:250px;max-width:250px}}#webmentions a:hover{text-decoration:none!important}section.subscriber{background:var(--border-color);width:820px;margin:40px auto;box-sizing:border-box;border-radius:5px;padding:30px 20px}@media only screen and (max-width:767px){section.subscriber{width:100%}}@media only screen and (max-width:992px)and (min-width:767px){section.subscriber{width:100%}}section.subscriber h4{margin:0;padding:10px 0 20px;color:var(--main-color);font-size:1.4rem}section.subscriber p{font-size:1rem;color:var(--parag-color);padding-bottom:10px}section.subscriber a{display:block;background-color:var(--primary-color);color:var(--bg-color);text-transform:uppercase;font-weight:600;text-align:center;padding:10px;margin-top:10px;border-radius:5px}section.all-project-list h3{margin-bottom:30px;font-size:1.6rem;font-weight:700;color:var(--main-color);text-transform:uppercase;display:flex;white-space:nowrap;align-items:center}section.all-project-list h3:before{width:5%;margin-right:30px}section.all-project-list h3:after,section.all-project-list h3:before{height:10px;border-radius:5px;background:var(--border-color);content:""}section.all-project-list h3:after{width:100%;margin-left:30px}section.all-project-list .index-blog ol{display:flex;flex-wrap:wrap;justify-content:space-between;column-gap:30px}section.all-project-list .index-blog ol li.general-list{width:48%}@media only screen and (max-width:992px)and (min-width:767px){section.all-project-list .index-blog ol li.general-list{width:48%}}@media only screen and (max-width:767px){section.all-project-list .index-blog ol li.general-list{width:100%}}section.all-project-list .index-blog a{padding:20px;display:block}section.all-project-list .index-blog a:hover{color:initial;background-color:var(--border-color);border-radius:5px}section.all-project-list .index-blog a:hover h2{color:var(--primary-color)}section.all-project-list .index-blog a:hover ul li{background-color:var(--border-offset-color)}section.all-project-list .index-blog header{display:flex;position:relative}section.all-project-list .index-blog header h2{font-size:1.7rem;font-weight:600;position:relative;padding-top:3px;margin-left:calc(1.8rem + 20px)}section.all-project-list .index-blog header b{position:absolute;left:10px;font-size:1.8rem}section.all-project-list .index-blog ul{padding:0;display:flex;flex-wrap:wrap;align-items:center;gap:10px;margin:13px 15px 13px 0}section.all-project-list .index-blog ul li{margin:0;list-style:none;background-color:var(--border-color);border-radius:5px;font-size:.8rem;padding:5px 10px;font-weight:600}section.all-project-list .index-blog p{color:var(--text-color);font-size:1.1rem}section.all-project-list .index-view-more{max-width:-moz-fit-content;max-width:fit-content;display:flex;justify-content:flex-start;font-weight:500;font-size:1.1rem;margin-top:30px;color:var(--primary-color);gap:5px;align-items:center;animation:shake 3s cubic-bezier(.1,.1,.1,.1) infinite both}@media only screen and (max-width:992px)and (min-width:767px){section.all-project-list .index-view-more{margin-left:20px}}@media only screen and (max-width:767px){section.all-project-list .index-view-more{margin-left:20px}}.react-photo-gallery--gallery{margin:30px 0}.footer-btn{border:1px solid grey;padding:10px 20px;color:#fff;font-weight:700;margin-top:-20px;margin-left:20px}.footer-btn:hover{opacity:.8;color:#fff}</style><meta name="generator" content="Gatsby 2.32.13"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'G-KG3PXM2G9B', 'auto', {});
      
      
      
      
      
      }</script><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=945dd495b5aa32271b63b1960971d41c" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#e4561b"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=945dd495b5aa32271b63b1960971d41c"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=945dd495b5aa32271b63b1960971d41c"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=945dd495b5aa32271b63b1960971d41c"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=945dd495b5aa32271b63b1960971d41c"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=945dd495b5aa32271b63b1960971d41c"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=945dd495b5aa32271b63b1960971d41c"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=945dd495b5aa32271b63b1960971d41c"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=945dd495b5aa32271b63b1960971d41c"/><title data-react-helmet="true">A World without Tensorflow or Pytorch | Violet Guo</title><link data-react-helmet="true" rel="webmention" href="https://webmention.io/violetguos.github.io/webmention"/><link data-react-helmet="true" rel="pingback" href="https://webmention.io/violetguos.github.io/xmlrpc"/><link data-react-helmet="true" href="https://twitter.com/yvioletguo" rel="me"/><link data-react-helmet="true" href="https://github.com/violetguos" rel="me"/><link data-react-helmet="true" rel="webmention" href="https://webmention.io/beratbozkurt.net/webmention"/><link data-react-helmet="true" rel="pingback" href="https://webmention.io/beratbozkurt.net/xmlrpc"/><meta data-react-helmet="true" name="description" content="Before neural netowrk frameworks were released, there was no effective way to automatically run gradient descent, defined model layer dimension, or initialize…"/><meta data-react-helmet="true" property="og:title" content="A World without Tensorflow or Pytorch"/><meta data-react-helmet="true" property="og:image" content="https://og-image.beratbozkurt0.vercel.app/**A World without Tensorflow or Pytorch**.png?md=1&amp;theme=dark"/><meta data-react-helmet="true" property="og:image:width"/><meta data-react-helmet="true" property="og:image:height"/><meta data-react-helmet="true" property="og:description" content="Before neural netowrk frameworks were released, there was no effective way to automatically run gradient descent, defined model layer dimension, or initialize…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content=""/><meta data-react-helmet="true" name="twitter:title" content="A World without Tensorflow or Pytorch"/><meta data-react-helmet="true" name="twitter:description" content="Before neural netowrk frameworks were released, there was no effective way to automatically run gradient descent, defined model layer dimension, or initialize…"/><link as="script" rel="preload" href="/webpack-runtime-1a6d59e57faa42d01602.js"/><link as="script" rel="preload" href="/framework-4ce5382688c7c66a6d68.js"/><link as="script" rel="preload" href="/styles-806f4b82980a743e7980.js"/><link as="script" rel="preload" href="/app-d7e1d4a2fe95b15f2988.js"/><link as="script" rel="preload" href="/commons-b5a5aa9fd2bd7c49f6e0.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-09dfcc9658b22e15a907.js"/><link as="fetch" rel="preload" href="/page-data/blog/neural-net-raw/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1983489297.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2652830850.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2841359383.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3255793931.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><section id="page"><div id="white"><section class="container"><header id="top"><h1><a href="/">Violet Guo</a></h1><nav id="navigation"><a href="/about">about</a><a href="/blog">blog</a><a href="/project">projects</a><button><svg width="20" fill="#656565" stroke="#656565" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></button></nav></header><article class="blog-post" itemscope="" itemType="http://schema.org/Article"><header><div class="top-of-post-image"><h1 class="display-font" itemProp="headline">A World without Tensorflow or Pytorch</h1><div class="top-of-header"><small>03 May 2024<!-- --> - <!-- -->5 min read</small><ul><li>machine learning</li></ul></div></div><div class="post-cover gatsby-image-wrapper" style="position:relative;overflow:hidden"><div aria-hidden="true" style="width:100%;padding-bottom:24.89795918367347%"></div><img aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAPoAAAD6AG1e1JrAAABEklEQVR42k1PPU+EQBTcX+GvMP4EK3sLY215Mf4FsbAx0YaYUJgrTMzVHhXJ+REiB4ZQUKCJjXhxj0CAnEs4WGAXWN9h41RvJm9m3kNpmhJCOOdt25ZliTHO8/yPgh4EAYj9gLquwzAsKBVCAG2aBjHGYBIDgAMFW7fBZtucm2AAERKrqqKUOk/q893lwnvteoFgFczxp8frkg/l/7OiKDIMw3Ecy7K+Mf7w3LOjveMddHG4TYs1mLu+ZfPJFQm/wHA7vpEkSZZlRVHiOIYg27ahGe7/IcR+eTwdHZzsbp2P9otshSAeyqPloirX8OkS4+n0XlXVh9ksy7IkSTRNc13XNE3f96FJ1/XJ+Np7e2es+QXI/QIv5XRQsQAAAABJRU5ErkJggg==" alt="A World without Tensorflow or Pytorch" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/fcf07ef82aeaf9e4823bfacba1bf91da/316fe/dogscience.png 245w,
/static/fcf07ef82aeaf9e4823bfacba1bf91da/6a537/dogscience.png 490w,
/static/fcf07ef82aeaf9e4823bfacba1bf91da/c5cc7/dogscience.png 980w,
/static/fcf07ef82aeaf9e4823bfacba1bf91da/f1ab0/dogscience.png 1470w,
/static/fcf07ef82aeaf9e4823bfacba1bf91da/96a87/dogscience.png 1960w,
/static/fcf07ef82aeaf9e4823bfacba1bf91da/26c64/dogscience.png 4134w" sizes="(max-width: 980px) 100vw, 980px" /><img loading="lazy" sizes="(max-width: 980px) 100vw, 980px" srcset="/static/fcf07ef82aeaf9e4823bfacba1bf91da/316fe/dogscience.png 245w,
/static/fcf07ef82aeaf9e4823bfacba1bf91da/6a537/dogscience.png 490w,
/static/fcf07ef82aeaf9e4823bfacba1bf91da/c5cc7/dogscience.png 980w,
/static/fcf07ef82aeaf9e4823bfacba1bf91da/f1ab0/dogscience.png 1470w,
/static/fcf07ef82aeaf9e4823bfacba1bf91da/96a87/dogscience.png 1960w,
/static/fcf07ef82aeaf9e4823bfacba1bf91da/26c64/dogscience.png 4134w" src="/static/fcf07ef82aeaf9e4823bfacba1bf91da/c5cc7/dogscience.png" alt="A World without Tensorflow or Pytorch" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div></header><section itemProp="articleBody"><p>Before neural netowrk frameworks were released, there was no effective way to automatically run gradient descent, defined model layer dimension, or initialize weights. All these features are baked into Tensorflow and Pytorch.</p>
<p>In a world without any neural network frameworks, we need to understand the fundamentals of a fully connected layer (aka MLP, neural network).</p>
<p>The following example assumes that we use the MNIST dataset.</p>
<h1>fully connected layer</h1>
<p>A matrix represents an image of a digit, and each cell is a pixel value. The image has dimension n by d.</p>
<p>Before passing through the activation function, we need to multiply the input by the weight and add the bias offset.</p>
<p>Mathmatically, it is represented like so</p>
<p>Wx^T + b</p>
<p>W: dh by d, where dh is the dimension of the hidden layer
x: n by d
b: dh by n</p>
<p>which yields a dh by n matrix.</p>
<p>The activation is applied per element of the matrix</p>
<pre class="grvsc-container quiet-light grvsc-ps-tuw09S" data-language="python" data-index="0"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-7 grvsc-tuw09S-11">def</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-9 grvsc-tZ0ymb-b grvsc-tuw09S-10">relu</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-7 grvsc-tuw09S-3">pre_activation</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">):</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">    </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-8">&#39;&#39;&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">    Relu using only numpy.</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">    </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-8">&#39;&#39;&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">    relu_output </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> np</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">zeros</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">pre_activation</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">shape</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">    relu_flat </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> relu_output</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">flatten</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">()</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">    </span><span class="grvsc-tZ0ymb-10 grvsc-tuw09S-11">for</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> i</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">,</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> neuron </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">in</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-9 grvsc-tZ0ymb-b grvsc-tuw09S-11">enumerate</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">pre_activation</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">flatten</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">()):</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-10 grvsc-tuw09S-11">if</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> neuron </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">&gt;</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-3">0</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">            relu_flat</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">[</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">i</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">]</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> neuron</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">    relu_output </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> relu_flat</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">reshape</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">pre_activation</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">shape</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">    </span><span class="grvsc-tZ0ymb-10 grvsc-tuw09S-11">return</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> relu_output</span></span></span></code></pre>
<p>The output after activation retains the same input matrix dimenion, in this case dh by n</p>
<h1>weight initialization</h1>
<p>If we initialized all the weights to 0, backpropogation will always be 0. There is nothing to learn.</p>
<p>Instead, a simple and effective initialization uses the hidden layer dimensions, and samples a matrix from a normal distribution, with the value bounded by the square root of $\frac{6}{sum of layer dimensions}$</p>
<pre class="grvsc-container quiet-light grvsc-ps-tuw09S" data-language="python" data-index="1"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-7 grvsc-tuw09S-11">def</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-9 grvsc-tZ0ymb-b grvsc-tuw09S-10">glorot_init</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-7 grvsc-tuw09S-3">d</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">,</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-7 grvsc-tuw09S-3">dh1</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">,</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-7 grvsc-tuw09S-3">dh2</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">,</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-7 grvsc-tuw09S-3">m</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">):</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">    dl_1 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> np</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">sqrt</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">((</span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-3">6</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">/</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">d </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">+</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> dh1</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">)))</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">    W_1 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> np</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">random</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">uniform</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">((</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">-</span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-3">1</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">)</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">*</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">dl_1</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">,</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> dl_1</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">,</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">dh1</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">,</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> d</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">))</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">    </span><span class="grvsc-tZ0ymb-10 grvsc-tuw09S-11">return</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> W_1</span></span></span></code></pre>
<p>The intuition behind this design is the forward propagation Wx^T + b will sum over every row in W, so having the layer’s dimension in the denominator will prevent the result Wx^T from exploding.</p>
<h1>Output</h1>
<p>Typically, we use softmax function to essentially <em>cast</em> a set of values into a probability distribution.
The output will retain the shape of the input to softmax, and each value can be interpreted as a probability.
The index of the maximum probability is the index of the predicted category.</p>
<pre class="grvsc-container quiet-light grvsc-ps-tuw09S" data-language="python" data-index="2"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-7 grvsc-tuw09S-11">def</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-9 grvsc-tZ0ymb-b grvsc-tuw09S-10">softmax</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-7 grvsc-tuw09S-3">pre_activation</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">):</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">    </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-8">&#39;&#39;&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">    Numerically stable because subtracting the max value makes bit overflow impossible,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">    we will only have non-positive values in the vector</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">    </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-8">&#39;&#39;&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">    exps </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> np</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">exp</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">pre_activation </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">-</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> np</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">max</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">pre_activation</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">))</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">    </span><span class="grvsc-tZ0ymb-10 grvsc-tuw09S-11">return</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> exps </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">/</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> np</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">sum</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">exps</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">)</span></span></span></code></pre>
<h1>Backpropagation</h1>
<p>The probability of an image of handwritten “1” to be 1 should be 100%.
We want to maximize this probability. Since we have the softmax representation from the forward propagation’s output, we want to maximize the softmax, aka we want softmax of the correct class to equal 1.</p>
<p>The following will require you thinking like a true mathematician. In order to maximize this probaility, we can minimize negative of the log-likelihood to achieve the same effect.</p>
<p>We don’t have a magically formula to find the weight values to minimize the negative log likehood. Instead, we modify the values so we move closer to the minimum log likelihood iteration by iteration. This can be done using gradient descent. For every iteration, we update the value of the weights by the value of this gradient.
If you are interested in the derivations, visit <a href="https://www.highonscience.com/blog/2021/06/18/ml-loss-function-cheat-sheet/#log-loss">this blog</a></p>
<pre class="grvsc-container quiet-light grvsc-ps-tuw09S" data-language="python" data-index="3"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">    </span><span class="grvsc-tZ0ymb-7 grvsc-tuw09S-11">def</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-9 grvsc-tZ0ymb-b grvsc-tuw09S-10">backprop</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-7 grvsc-tuw09S-3">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">,</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-7 grvsc-tuw09S-3">batch_data</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">,</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-7 grvsc-tuw09S-3">batch_target</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">):</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-8">&#39;&#39;&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">        dimensions:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">        o_s: m x1</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">        grad_oa : m x 1</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">        hs: dh x 1</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">        grad_w2: m x dh</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">        grad_oa: m x n</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">        grad_b2: m x n</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">        grad_oa: m x n</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">        W(2): m x dh</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">        grad_hs: dh x n</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">        grad_oa: m x n</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">        grad_ha: dh x n</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">        x : n x d</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">        grad_W1: dh x d</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">        grad_ha: dh x n</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">        grad_b1: dh x n</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-4 grvsc-tuw09S-8">        </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-8">&#39;&#39;&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_oa </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">o_s </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">-</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> batch_target</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-3 grvsc-tZ0ymb-i grvsc-tuw09S-4"># hidden layer 3</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_W3 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> np</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">outer</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_oa</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">,</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">h_s2</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">T</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_b3 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_oa</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_hs2 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> np</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">dot</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">W_3</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">T</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">,</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_oa</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        h_a_stack2 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> np</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">where</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">h_a2 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">&gt;</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-3">0</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">,</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-3">1</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">,</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-3">0</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_ha2 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> np</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">multiply</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_hs2</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">,</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> h_a_stack2</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_W2 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> np</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">outer</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_ha2</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">,</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">h_s1</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">T</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_b2 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_ha2</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_hs1 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> np</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">dot</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">W_2</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">T </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">,</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_ha2</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        h_a_stack1 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> np</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">where</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">h_a1 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">&gt;</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-3">0</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">,</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-3">1</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">,</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-3">0</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_ha1 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> np</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">multiply</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_hs1</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">,</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> h_a_stack1</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-3 grvsc-tZ0ymb-i grvsc-tuw09S-4"># hidden layer 1</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_W1 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> np</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">outer</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_ha1</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">,</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> batch_data</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_b1 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_ha1</span></span></span></code></pre>
<p>After we obtained the gradients for each layer, we apply the <em>descent</em> by subtracting it from the weights. The learning rate serves as a control, and can be designed to be adaptive according to the shape of the loss function to accelerate or decelrate the descent.</p>
<pre class="grvsc-container quiet-light grvsc-ps-tuw09S" data-language="python" data-index="4"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">    </span><span class="grvsc-tZ0ymb-7 grvsc-tuw09S-11">def</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-9 grvsc-tZ0ymb-b grvsc-tuw09S-10">update_weights</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">(</span><span class="grvsc-tZ0ymb-7 grvsc-tuw09S-3">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">):</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">W_1 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">-=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_W1 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">*</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">learning_rate</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">W_2 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">-=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_W2 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">*</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">learning_rate</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">W_3 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">-=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_W3 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">*</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">learning_rate</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">b_1 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">-=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_b1 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">*</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">learning_rate</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">b_2 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">-=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_b2 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">*</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">learning_rate</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">        </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">b_3 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">-=</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">grad_b3 </span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-15">*</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1"> </span><span class="grvsc-tZ0ymb-5 grvsc-tuw09S-13">self</span><span class="grvsc-tZ0ymb-6 grvsc-tuw09S-1">.</span><span class="grvsc-tZ0ymb-1 grvsc-tuw09S-1">learning_rate</span></span></span></code></pre>
<p>The update is performed for every single image (aka our input data) over a number of times. Each complete set is referred to as an epoch. The number of epoch is usually determined at run time using early stopping. There is no consensus on how many epochs to run, and more isn’t always better.</p>
<p>There is probably no occasion where we will actually write everything using numpy and pretend we don’t have tensorflow or pytorch. This post aims to provide some visbility into a simple neural network training works, and why the frameworks are appreciated in the ML community.</p>
<style class="grvsc-styles">
  .grvsc-container {
    overflow: auto;
    position: relative;
    -webkit-overflow-scrolling: touch;
    padding-top: 1rem;
    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));
    padding-bottom: 1rem;
    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));
    border-radius: 8px;
    border-radius: var(--grvsc-border-radius, 8px);
    font-feature-settings: normal;
    line-height: 1.4;
  }
  
  .grvsc-code {
    display: table;
  }
  
  .grvsc-line {
    display: table-row;
    box-sizing: border-box;
    width: 100%;
    position: relative;
  }
  
  .grvsc-line > * {
    position: relative;
  }
  
  .grvsc-gutter-pad {
    display: table-cell;
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  .grvsc-gutter {
    display: table-cell;
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter::before {
    content: attr(data-content);
  }
  
  .grvsc-source {
    display: table-cell;
    padding-left: 1.5rem;
    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));
    padding-right: 1.5rem;
    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));
  }
  
  .grvsc-source:empty::after {
    content: ' ';
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter + .grvsc-source {
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  /* Line transformer styles */
  
  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {
    content: ' ';
    position: absolute;
    width: 100%;
  }
  
  .grvsc-line-diff-add::before {
    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));
  }
  
  .grvsc-line-diff-del::before {
    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));
  }
  
  .grvsc-line-number {
    padding: 0 2px;
    text-align: right;
    opacity: 0.7;
  }
  
  .quiet-light { background-color: #F5F5F5; }
  .quiet-light .grvsc-tZ0ymb-i { font-style: italic; }
  .quiet-light .grvsc-tZ0ymb-b { font-weight: bold; }
  .quiet-light .grvsc-tZ0ymb-7 { color: #7A3E9D; }
  .quiet-light .grvsc-tZ0ymb-1 { color: #333333; }
  .quiet-light .grvsc-tZ0ymb-9 { color: #AA3731; }
  .quiet-light .grvsc-tZ0ymb-6 { color: #777777; }
  .quiet-light .grvsc-tZ0ymb-4 { color: #448C27; }
  .quiet-light .grvsc-tZ0ymb-10 { color: #4B69C6; }
  .quiet-light .grvsc-tZ0ymb-5 { color: #9C5D27; }
  .quiet-light .grvsc-tZ0ymb-3 { color: #AAAAAA; }
  .quiet-light .grvsc-line-highlighted::before {
    background-color: var(--grvsc-line-highlighted-background-color, rgba(0, 0, 0, 0.05));
    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(0, 0, 0, 0.2));
  }
  div#dark .grvsc-ps-tuw09S {
    background-color: #1e1e1e;
    color: #c5c8c6;
  }
  div#dark .grvsc-ps-tuw09S .grvsc-tuw09S-11 { color: #9872A2; }
  div#dark .grvsc-ps-tuw09S .grvsc-tuw09S-1 { color: #C5C8C6FF; }
  div#dark .grvsc-ps-tuw09S .grvsc-tuw09S-10 { color: #CE6700; }
  div#dark .grvsc-ps-tuw09S .grvsc-tuw09S-3 { color: #6089B4; }
  div#dark .grvsc-ps-tuw09S .grvsc-tuw09S-8 { color: #9AA83A; }
  div#dark .grvsc-ps-tuw09S .grvsc-tuw09S-15 { color: #676867; }
  div#dark .grvsc-ps-tuw09S .grvsc-tuw09S-13 { color: #C7444A; }
  div#dark .grvsc-ps-tuw09S .grvsc-tuw09S-4 { color: #9A9B99; }
  div#dark .grvsc-ps-tuw09S .grvsc-line-highlighted::before {
    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));
    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));
  }
</style></section></article><div class="bottom-article"><div class="share-post"><a href="https://twitter.com/intent/tweet?url=https://violetguos.github.io/blog/neural-net-raw/&amp;via=yvioletguo&amp;text=A World without Tensorflow or Pytorch" target="_blank" rel="noreferrer"><svg width="21" height="21" fill="#3294da" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512" xml:space="preserve"><g><g><path d="M512,97.248c-19.04,8.352-39.328,13.888-60.48,16.576c21.76-12.992,38.368-33.408,46.176-58.016
			c-20.288,12.096-42.688,20.64-66.56,25.408C411.872,60.704,384.416,48,354.464,48c-58.112,0-104.896,47.168-104.896,104.992
			c0,8.32,0.704,16.32,2.432,23.936c-87.264-4.256-164.48-46.08-216.352-109.792c-9.056,15.712-14.368,33.696-14.368,53.056
			c0,36.352,18.72,68.576,46.624,87.232c-16.864-0.32-33.408-5.216-47.424-12.928c0,0.32,0,0.736,0,1.152
			c0,51.008,36.384,93.376,84.096,103.136c-8.544,2.336-17.856,3.456-27.52,3.456c-6.72,0-13.504-0.384-19.872-1.792
			c13.6,41.568,52.192,72.128,98.08,73.12c-35.712,27.936-81.056,44.768-130.144,44.768c-8.608,0-16.864-0.384-25.12-1.44
			C46.496,446.88,101.6,464,161.024,464c193.152,0,298.752-160,298.752-298.688c0-4.64-0.16-9.12-0.384-13.568
			C480.224,136.96,497.728,118.496,512,97.248z"></path></g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg></a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https://violetguos.github.io/blog/neural-net-raw/" target="_blank" rel="noreferrer"><svg width="21" height="21" fill="#1966c2" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512" xml:space="preserve"><g><g><rect y="160" width="114.496" height="352"></rect></g></g><g><g><path d="M426.368,164.128c-1.216-0.384-2.368-0.8-3.648-1.152c-1.536-0.352-3.072-0.64-4.64-0.896
			c-6.08-1.216-12.736-2.08-20.544-2.08c-66.752,0-109.088,48.544-123.04,67.296V160H160v352h114.496V320
			c0,0,86.528-120.512,123.04-32c0,79.008,0,224,0,224H512V274.464C512,221.28,475.552,176.96,426.368,164.128z"></path></g></g><g><g><circle cx="56" cy="56" r="56"></circle></g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg></a><a href="https://www.facebook.com/sharer/sharer.php?u=https://violetguos.github.io/blog/neural-net-raw/" target="_blank" rel="noreferrer"><svg width="21" height="21" fill="#1B77F2" xmlnsSvgjs="http://svgjs.com/svgjs" version="1.1" x="0" y="0" viewBox="0 0 155.139 155.139" style="enable-background:new 0 0 512 512" xml:space="preserve" class=""><g><g><path id="f_1_" d="M89.584,155.139V84.378h23.742l3.562-27.585H89.584V39.184   c0-7.984,2.208-13.425,13.67-13.425l14.595-0.006V1.08C115.325,0.752,106.661,0,96.577,0C75.52,0,61.104,12.853,61.104,36.452   v20.341H37.29v27.585h23.814v70.761H89.584z" fill="#1b77f2" data-original="#010002" class=""></path></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></g></svg></a><svg width="21" height="21" class="copy-icon" viewBox="-40 0 512 512"><path d="m271 512h-191c-44.113281 0-80-35.886719-80-80v-271c0-44.113281 35.886719-80 80-80h191c44.113281 0 80 35.886719 80 80v271c0 44.113281-35.886719 80-80 80zm-191-391c-22.054688 0-40 17.945312-40 40v271c0 22.054688 17.945312 40 40 40h191c22.054688 0 40-17.945312 40-40v-271c0-22.054688-17.945312-40-40-40zm351 261v-302c0-44.113281-35.886719-80-80-80h-222c-11.046875 0-20 8.953125-20 20s8.953125 20 20 20h222c22.054688 0 40 17.945312 40 40v302c0 11.046875 8.953125 20 20 20s20-8.953125 20-20zm0 0"></path></svg></div><div class="like-count"><button><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="feather feather-heart"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>0</button></div></div><nav class="blog-post-nav"><li><a rel="prev" href="/blog/tree-data/">← <!-- -->Writing Good Code vs Training More Models</a></li><li><a rel="next" href="/blog/margin-note-llama/">What MLEs can learn from the LLaMA Paper About Efficient LLM Models<!-- --> →</a></li></nav><div id="webmentions" class="container" style="display:block"><h2><a href="https://mobile.twitter.com/search?q=https://violetguos.github.io/blog/neural-net-raw/" target="_blank" class="discuss-twitter" rel="noreferrer"><svg width="21" height="21" fill="white" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512" xml:space="preserve"><g><g><path d="M512,97.248c-19.04,8.352-39.328,13.888-60.48,16.576c21.76-12.992,38.368-33.408,46.176-58.016
			c-20.288,12.096-42.688,20.64-66.56,25.408C411.872,60.704,384.416,48,354.464,48c-58.112,0-104.896,47.168-104.896,104.992
			c0,8.32,0.704,16.32,2.432,23.936c-87.264-4.256-164.48-46.08-216.352-109.792c-9.056,15.712-14.368,33.696-14.368,53.056
			c0,36.352,18.72,68.576,46.624,87.232c-16.864-0.32-33.408-5.216-47.424-12.928c0,0.32,0,0.736,0,1.152
			c0,51.008,36.384,93.376,84.096,103.136c-8.544,2.336-17.856,3.456-27.52,3.456c-6.72,0-13.504-0.384-19.872-1.792
			c13.6,41.568,52.192,72.128,98.08,73.12c-35.712,27.936-81.056,44.768-130.144,44.768c-8.608,0-16.864-0.384-25.12-1.44
			C46.496,446.88,101.6,464,161.024,464c193.152,0,298.752-160,298.752-298.688c0-4.64-0.16-9.12-0.384-13.568
			C480.224,136.96,497.728,118.496,512,97.248z"></path></g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg><b>Twitter</b></a></h2></div><footer><nav id="social"><a href="https://www.youtube.com/@codebuzz-v1d" target="_blank" rel="me noreferrer"><svg width="21" height="21" version="1.1" id="Layer_1" viewBox="0 0 461.001 461.001" xml:space="preserve"><g><path style="fill:#F61C0D" d="M365.257,67.393H95.744C42.866,67.393,0,110.259,0,163.137v134.728
		c0,52.878,42.866,95.744,95.744,95.744h269.513c52.878,0,95.744-42.866,95.744-95.744V163.137
		C461.001,110.259,418.135,67.393,365.257,67.393z M300.506,237.056l-126.06,60.123c-3.359,1.602-7.239-0.847-7.239-4.568V168.607
		c0-3.774,3.982-6.22,7.348-4.514l126.06,63.881C304.363,229.873,304.298,235.248,300.506,237.056z"></path></g></svg></a><a href="https://github.com/violetguos" target="_blank" rel="noreferrer"><svg width="21" height="21" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512" xml:space="preserve"><g><g><path d="M255.968,5.329C114.624,5.329,0,120.401,0,262.353c0,113.536,73.344,209.856,175.104,243.872
			c12.8,2.368,17.472-5.568,17.472-12.384c0-6.112-0.224-22.272-0.352-43.712c-71.2,15.52-86.24-34.464-86.24-34.464
			c-11.616-29.696-28.416-37.6-28.416-37.6c-23.264-15.936,1.728-15.616,1.728-15.616c25.696,1.824,39.2,26.496,39.2,26.496
			c22.848,39.264,59.936,27.936,74.528,21.344c2.304-16.608,8.928-27.936,16.256-34.368
			c-56.832-6.496-116.608-28.544-116.608-127.008c0-28.064,9.984-51.008,26.368-68.992c-2.656-6.496-11.424-32.64,2.496-68
			c0,0,21.504-6.912,70.4,26.336c20.416-5.696,42.304-8.544,64.096-8.64c21.728,0.128,43.648,2.944,64.096,8.672
			c48.864-33.248,70.336-26.336,70.336-26.336c13.952,35.392,5.184,61.504,2.56,68c16.416,17.984,26.304,40.928,26.304,68.992
			c0,98.72-59.84,120.448-116.864,126.816c9.184,7.936,17.376,23.616,17.376,47.584c0,34.368-0.32,62.08-0.32,70.496
			c0,6.88,4.608,14.88,17.6,12.352C438.72,472.145,512,375.857,512,262.353C512,120.401,397.376,5.329,255.968,5.329z"></path></g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg></a><a href="https://www.linkedin.com/in/yvioletguo/" target="_blank" rel="noreferrer"><svg width="21" height="21" fill="#1966c2" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512" xml:space="preserve"><g><g><rect y="160" width="114.496" height="352"></rect></g></g><g><g><path d="M426.368,164.128c-1.216-0.384-2.368-0.8-3.648-1.152c-1.536-0.352-3.072-0.64-4.64-0.896
			c-6.08-1.216-12.736-2.08-20.544-2.08c-66.752,0-109.088,48.544-123.04,67.296V160H160v352h114.496V320
			c0,0,86.528-120.512,123.04-32c0,79.008,0,224,0,224H512V274.464C512,221.28,475.552,176.96,426.368,164.128z"></path></g></g><g><g><circle cx="56" cy="56" r="56"></circle></g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg></a></nav><div class="email">Please reach out:<!-- --> <a href="obfuscated" style="unicode-bidi:bidi-override;display:inline-block;direction:rtl">gro.mca@gteloiv</a></div></footer></section></div></section></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/neural-net-raw/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-0874303322eafb4b7304.js"],"app":["/app-d7e1d4a2fe95b15f2988.js"],"component---src-pages-404-js":["/component---src-pages-404-js-1d2159aff7fc76c05aaf.js"],"component---src-pages-about-js":["/component---src-pages-about-js-96944287086e5e1cecf1.js"],"component---src-pages-blog-js":["/component---src-pages-blog-js-1bd2769e2653a3f6e029.js"],"component---src-pages-index-js":["/component---src-pages-index-js-353784ea9daa59f9f93e.js"],"component---src-pages-project-js":["/component---src-pages-project-js-db16fa0d968d4a5221bb.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-09dfcc9658b22e15a907.js"]};/*]]>*/</script><script src="/polyfill-0874303322eafb4b7304.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-09dfcc9658b22e15a907.js" async=""></script><script src="/commons-b5a5aa9fd2bd7c49f6e0.js" async=""></script><script src="/app-d7e1d4a2fe95b15f2988.js" async=""></script><script src="/styles-806f4b82980a743e7980.js" async=""></script><script src="/framework-4ce5382688c7c66a6d68.js" async=""></script><script src="/webpack-runtime-1a6d59e57faa42d01602.js" async=""></script></body></html>